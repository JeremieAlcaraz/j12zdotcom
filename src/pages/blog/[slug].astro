---
import BaseLayout from '@/layouts/Base.astro'
import PostSingle from '@/domain/blog/layouts/PostSingle.astro'
import { getSinglePage } from '@/utils/contentParser'

export async function getStaticPaths() {
  const BLOG_FOLDER = 'blog'
  const posts = await getSinglePage(BLOG_FOLDER)

  const paths = posts.map(post => ({
    params: {
      slug: post.id,
    },
    props: { post },
  }))

  return paths
}

const { post } = Astro.props
const { title, meta_title, description, image, date, author } = post.data

// Pr√©parer les dates pour Open Graph
const publishedTime = date instanceof Date ? date.toISOString() : new Date(date).toISOString()
---

<BaseLayout
  title={title}
  meta_title={meta_title}
  description={description}
  image={image}
  contentType="article"
  publishedTime={publishedTime}
  modifiedTime={publishedTime}
  author={author}
>
  <PostSingle post={post} />
</BaseLayout>
