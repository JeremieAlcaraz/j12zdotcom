---
import StyleGuideLayout from '@/layouts/StyleGuideLayout.astro'
import ComponentGallery from '@/components/dev/ComponentGallery.astro'
import CardBlogGallery from '@/components/dev/CardBlogGallery.astro'
import CardPricingGallery from '@/components/dev/CardPricingGallery.astro'
import CardVariantsGallery from '@/components/dev/CardVariantsGallery.astro'
import { getSinglePage } from '@/utils/contentParser'
import { sortByDate } from '@/utils/sortFunctions'

const modules = import.meta.glob('@/components/organisms/**/*.astro', { eager: true })

const BLOG_FOLDER = 'blog'
const posts = await getSinglePage(BLOG_FOLDER)
const sortedPosts = sortByDate(posts)
const currentPosts = sortedPosts.slice(0, 3)

const demoProps = {
  PostSidebar: { categories: ['astro', 'dev'], allCategories: ['astro', 'dev', 'astro'] },
}

const extra = [
  {
    name: 'Card',
    Component: CardVariantsGallery,
  },
  {
    name: 'Card (blog variant)',
    Component: CardBlogGallery,
    props: { posts: currentPosts },
  },
  {
    name: 'Card (pricing variant)',
    Component: CardPricingGallery,
  },
]
---

<StyleGuideLayout title="Style Guide | Organisms">
  <ComponentGallery
    modules={modules}
    demoProps={demoProps}
    exclude={['TestimonialCard', 'Card']}
    extra={extra}
  />
</StyleGuideLayout>
