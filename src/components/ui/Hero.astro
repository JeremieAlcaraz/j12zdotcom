---
import Halo from '@components/ui/Halo.astro';
import ImageMod from '@components/common/ImageMod.astro';
import { markdownify } from '@/utils/textConverter';
import type { Button, Feature } from '@/types';
import type { CollectionEntry } from 'astro:content';
import { getEntry } from 'astro:content';

interface Homepage {
  banner: { title: string; content: string; image: string; button: Button };
  features: Feature[];
}

const homepage = (await getEntry('homepage', 'index')) as CollectionEntry<'homepage'>;
const { banner } = homepage.data as Homepage;
---

<div class="hero min-h-screen flex items-center justify-center">
  <div
    class="flex flex-col lg:flex-row items-center max-w-full gap-12 px-4 transform -translate-y-16 lg:-translate-y-20"
  >
    <!-- COLONNE IMAGE avec Halo -->
    <div class="relative w-96 h-96 flex-shrink-0">
      <Halo />
      {
        banner.image && (
          <div class="absolute inset-0 flex items-center justify-center z-10">
            <div class="w-full h-full rounded-full overflow-hidden shadow-2xl">
              <ImageMod
                src={banner.image}
                width={600}
                height={600}
                alt="Portrait de Jérémie"
                format="webp"
                class="object-cover w-full h-full"
              />
            </div>
          </div>
        )
      }
    </div>

    <!-- COLONNE TEXTE -->
    <div class="text-center lg:text-left max-w-2xl">
      <h1 set:html={markdownify(banner.title)} class="text-5xl font-bold mb-4" />
      <p set:html={markdownify(banner.content)} class="py-6 text-lg" />
      {
        banner.button.enable && (
          <a
            href={banner.button.link}
            target={banner.button.link.startsWith('http') ? '_blank' : '_self'}
            rel="noopener"
            class="btn btn-primary btn-lg"
          >
            {banner.button.label}
          </a>
        )
      }
    </div>
  </div>
</div>
