---
import Card from '@ui/organisms/Card.astro'
import ImageMod from '@ui/atoms/ImageMod.astro'
import config from '@/config/siteConfig.ts'
import dateFormat from '@/utils/dateFormat'
import { humanize, slugify, smartTruncate } from '@/utils/textConverter'
import { FaRegUserCircle } from 'react-icons/fa'

interface Props {
  data: any
  base?: 100 | 200 | 300
}

const { data, base = 100 } = Astro.props as Props
const { summaryLength, blogFolder }: { summaryLength: number; blogFolder: string } = config.settings
const { title, image, date, author } = data.data
---

<Card class="flex h-full flex-col shadow-sm" base={base}>
  {
    image && (
      <ImageMod
        slot="image"
        class="h-48 w-full object-cover"
        src={image}
        alt={title}
        width={445}
        height={230}
        format="webp"
      />
    )
  }
  <a slot="title" href={`/${blogFolder}/${data.id}`} class="link link-hover line-clamp-2">
    {title}
  </a>
  <div class="mb-3 flex flex-wrap items-center gap-3 text-sm opacity-70">
    <div class="flex items-center gap-1.5">
      <FaRegUserCircle className="shrink-0 text-xs" />
      <a href={`/authors/${slugify(author)}`} class="link link-hover text-xs">
        {humanize(author)}
      </a>
    </div>
    {
      date && (
        <time datetime={date} class="text-xs">
          {dateFormat(date)}
        </time>
      )
    }
  </div>
  <p class="text-base-content/70 line-clamp-3 text-sm leading-relaxed">
    {smartTruncate(data.body || '', summaryLength || 150)}
  </p>
  <div slot="actions" class="mt-4 justify-end pt-3">
    <a href={`/${blogFolder}/${data.id}`} class="btn btn-primary btn-sm"> Lire la suite </a>
  </div>
</Card>
