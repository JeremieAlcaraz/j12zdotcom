---
import ImageMod from '@/ui/atoms/ImageMod.astro'
import Badge from '@/ui/atoms/Badge.astro'
import Checkbox from '@/ui/atoms/Checkbox.astro'
import { markdownify } from '@/utils/textConverter'
import { getEntry } from 'astro:content'

const aboutEntry = await getEntry('about', 'index')
if (!aboutEntry) {
  throw new Error('About entry not found! Check src/content/about/index.mdx')
}

const { differences } = aboutEntry.data
---

<section class="section-sm">
  <div class="container">
    <div class="grid grid-cols-1 items-center gap-8 lg:grid-cols-[5fr_8fr] lg:gap-12 xl:gap-16">
      <!-- Content avec avantages concrets -->
      <div class="order-2 space-y-8 lg:order-2 lg:pl-8">
        <div class="space-y-6">
          <h2 class="text-3xl font-bold leading-tight text-base-content md:text-4xl lg:text-5xl">
            {differences.title}
          </h2>

          <div class="space-y-4">
            <p class="text-lg text-base-content/80 leading-relaxed" set:html={markdownify(differences.introduction.main)}>
            </p>

            <p class="text-base text-base-content/70 leading-relaxed" set:html={markdownify(differences.introduction.secondary)}>
            </p>
          </div>
        </div>

        <!-- Mes forces uniques -->
        <div class="space-y-6">
          <h3 class="text-xl font-semibold text-base-content">{differences.strengths.title}</h3>

          <div class="space-y-4">
            {differences.strengths.items.map((strength) => (
              <div class={`group p-4 rounded-xl bg-gradient-to-r from-${strength.color}/5 to-transparent border border-${strength.color}/10 hover:border-${strength.color}/20 transition-colors`}>
                <div class="flex items-start space-x-3">
                  <Checkbox checked disabled color={strength.color} size="sm" />
                  <div class="space-y-2">
                    <h4 class="font-semibold text-base-content flex items-center gap-2">
                      {strength.icon} {strength.title}
                      <Badge label={strength.badge} variant={strength.badgeVariant} />
                    </h4>
                    <p class="text-sm text-base-content/70">
                      {strength.description}
                    </p>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>

        <!-- T√©moignage subtil -->
        <div class="relative">
          <div class="bg-base-200/50 rounded-2xl p-6 backdrop-blur-sm">
            <p class="text-base italic text-base-content/80 mb-3">
              "{differences.testimonial.quote}"
            </p>
            <div class="flex items-center justify-between">
              <footer class="text-sm text-base-content/60">
                ‚Äî {differences.testimonial.author}
              </footer>
              <div class="flex space-x-1">
                {Array.from({ length: differences.testimonial.stars }, () => (
                  <span class="text-yellow-400">‚≠ê</span>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Image avec badges flottants -->
      <div class="order-1 flex justify-center lg:order-1 lg:justify-start">
        <div class="relative">
          <div
            class="mask mask-diamond h-80 w-80 overflow-hidden shadow-xl transition-all duration-300 hover:scale-105 hover:shadow-2xl md:h-96 md:w-96 lg:h-[400px] lg:w-[400px]"
          >
            {
              differences.image && (
                <ImageMod
                  src={differences.image}
                  alt={differences.title}
                  width={600}
                  height={600}
                  format="webp"
                  class="h-full w-full object-cover"
                />
              )
            }
          </div>
          <!-- Subtle accent background -->
          <div class="absolute -inset-4 -z-10 rounded-3xl bg-gradient-to-br from-secondary/10 to-accent/10 blur-xl"></div>

          <!-- Floating achievement badges -->
          <div class="absolute -top-6 -left-4">
            <Badge label="üèÜ Expert" variant="primary" />
          </div>
          <div class="absolute -bottom-4 -right-6">
            <Badge label="üí° Innovateur" variant="secondary" />
          </div>
          <div class="absolute top-1/2 -right-8 -translate-y-1/2">
            <Badge label="ü§ù Bienveillant" variant="neutral" />
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
