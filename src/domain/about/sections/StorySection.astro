---
import ImageMod from '@/ui/atoms/ImageMod.astro'
import Badge from '@/ui/atoms/Badge.astro'
import Checkbox from '@/ui/atoms/Checkbox.astro'
import Quote from '@/ui/molecules/Quote.astro'
import { markdownify } from '@/utils/textConverter'
import { getEntry } from 'astro:content'

const aboutEntry = await getEntry('about', 'index')
if (!aboutEntry) {
  throw new Error('About entry not found! Check src/content/about/index.mdx')
}

const { story } = aboutEntry.data
---

<section class="section-sm">
  <div class="container">
    <div class="grid grid-cols-1 items-center gap-8 lg:grid-cols-[8fr_5fr] lg:gap-12 xl:gap-16">
      <!-- Image avec proportions harmonieuses -->
      <div class="order-2 flex justify-center lg:order-2 lg:justify-end">
        <div class="relative">
          <div
            class="mask mask-hexagon h-80 w-80 overflow-hidden shadow-xl transition-all duration-300 hover:scale-105 hover:shadow-2xl md:h-96 md:w-96 lg:h-[400px] lg:w-[400px]"
          >
            {
              story.image && (
                <ImageMod
                  src={story.image}
                  alt={story.title}
                  width={600}
                  height={600}
                  format="webp"
                  class="h-full w-full object-cover"
                />
              )
            }
          </div>
          <!-- Subtle accent background -->
          <div class="absolute -inset-4 -z-10 rounded-3xl bg-gradient-to-br from-accent/10 to-primary/10 blur-xl"></div>

          <!-- Timeline badges -->
          <div class="absolute -top-6 left-1/2 -translate-x-1/2">
            <Badge label="ðŸš€ Mon parcours" variant="primary" />
          </div>
          <div class="absolute -bottom-6 right-4">
            <Badge label="âœ¨ RÃ©vÃ©lation" variant="secondary" />
          </div>
        </div>
      </div>

      <!-- Content avec rÃ©cit inspirant -->
      <div class="order-1 space-y-8 lg:order-1 lg:pr-8">
        <div class="space-y-6">
          <h2 class="text-3xl font-bold leading-tight text-base-content md:text-4xl lg:text-5xl">
            {story.title}
          </h2>

          <div class="space-y-6">
            <div class="space-y-4">
              <p class="text-lg text-base-content/80 leading-relaxed" set:html={markdownify(story.introduction.frustration)}>
              </p>

              <p class="text-base text-base-content/70 leading-relaxed" set:html={markdownify(story.introduction.realization)}>
              </p>
            </div>

            <!-- Mes dÃ©couvertes clÃ©s -->
            <div class="bg-gradient-to-r from-secondary/5 to-accent/5 rounded-2xl p-6 border border-secondary/10">
              <h4 class="text-lg font-semibold text-base-content mb-4">{story.revelations.title}</h4>

              <div class="space-y-3">
                {story.revelations.items.map((revelation) => (
                  <div class="flex items-start space-x-3">
                    <Checkbox checked disabled color={revelation.color} size="sm" />
                    <div>
                      <p class="text-base-content/80"><strong>{revelation.title}</strong> {revelation.description}</p>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            <!-- L'Ã©volution -->
            <div class="space-y-4">
              <p class="text-base text-base-content/70 leading-relaxed" set:html={markdownify(story.evolution.approach)}>
              </p>

              <p class="text-base text-base-content/70 leading-relaxed" set:html={markdownify(story.evolution.mission)}>
              </p>
            </div>
          </div>
        </div>

        <!-- Citation inspirante -->
        <div class="relative mt-8">
          <Quote
            quote={story.quote.text}
            author={story.quote.author}
            emoji="ðŸ’¡"
          />
        </div>
      </div>
    </div>
  </div>
</section>
